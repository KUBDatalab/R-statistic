<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R-statistic: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/lc/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/lc/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/lc/favicon-16x16.png">
<link rel="manifest" href="favicons/lc/site.webmanifest">
<link rel="mask-icon" href="favicons/lc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav library"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="lc-logo" alt="Library Carpentry" src="assets/images/library-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="assets/images/library-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R-statistic
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R-statistic
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="CLT-dk.html">CLT - p√• dansk</a></li>
<li><a class="dropdown-item" href="CLT-en.html">CLT - in english</a></li>
<li><a class="dropdown-item" href="data.html">Data sets</a></li>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R-statistic
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="descript-stat.html">1. Descriptive Statistics</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="tidy-data.html">2. Tidy Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="normal-distribution.html">3. The normal distribution</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="is-it-normal.html">4. Testing for normality</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="which-distribution.html">5. How is the data distributed?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="linear-regression.html">6. Linear regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="multiple-linear-regression.html">7. Multiple Linear Regression</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="CLT-dk.html">CLT - p√• dansk</a></li>
<li><a href="CLT-en.html">CLT - in english</a></li>
<li><a href="data.html">Data sets</a></li>
<li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-descript-stat"><p>Content from <a href="descript-stat.html">Descriptive Statistics</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/descript-stat.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we describe a set of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn about the most common ways of describing a variable</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Descriptive statistic involves summarising or describing a set of
data. It usually presents quantitative descriptions in a short form, and
helps to simplify large datasets.</p>
<p>Most descriptive statistical parameters applies to just one variable
in our data, and includes:</p>
<table class="table">
<thead><tr class="header">
<th>Central tendency</th>
<th>Measure of variation</th>
<th>Measure of shape</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mean</td>
<td>Range</td>
<td>Skewness</td>
</tr>
<tr class="even">
<td>Median</td>
<td>Quartiles</td>
<td>Kurtosis</td>
</tr>
<tr class="odd">
<td>Mode</td>
<td>Inter Quartile Range</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Variance</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>Standard deviation</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>Percentiles</td>
<td></td>
</tr>
</tbody>
</table></section><section><h2 class="section-heading" id="central-tendency">Central tendency<a class="anchor" aria-label="anchor" href="#central-tendency"></a>
</h2>
<hr class="half-width">
<p>The easiest way to get summary statistics on data is to use the
<code>summarise</code> function from the <code>tidyverse</code>
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>In the following we are working with the <code>palmerpenguins</code>
dataset. Note that the actual data is called <code>penguins</code> and
is part of the package <code>palmerpenguins</code>:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 √ó 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7               181        3750
2 Adelie  Torgersen           39.5          17.4               186        3800
3 Adelie  Torgersen           40.3          18                 195        3250
4 Adelie  Torgersen           NA            NA                  NA          NA
5 Adelie  Torgersen           36.7          19.3               193        3450
6 Adelie  Torgersen           39.3          20.6               190        3650
# ‚Ñπ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
<p>344 penguins have been recorded at three different islands over three
years. Three different penguin species are in the dataset, and we have
data on their weight, sex, length of their flippers and two measurements
of their bill (beak).</p>
<p><img src="fig/culmen_depth.png" alt="What is lenght and depth of penguin bills?" class="figure">{Copyright Allison
Horst}</p>
<p>Specifically we are going to work with the weight of the penguins,
stored in the variable <code>body_mass_g</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] 3750 3800 3250   NA 3450 3650 3625 4675 3475 4250 3300 3700 3200 3800 4400
 [16] 3700 3450 4500 3325 4200 3400 3600 3800 3950 3800 3800 3550 3200 3150 3950
 [31] 3250 3900 3300 3900 3325 4150 3950 3550 3300 4650 3150 3900 3100 4400 3000
 [46] 4600 3425 2975 3450 4150 3500 4300 3450 4050 2900 3700 3550 3800 2850 3750
 [61] 3150 4400 3600 4050 2850 3950 3350 4100 3050 4450 3600 3900 3550 4150 3700
 [76] 4250 3700 3900 3550 4000 3200 4700 3800 4200 3350 3550 3800 3500 3950 3600
 [91] 3550 4300 3400 4450 3300 4300 3700 4350 2900 4100 3725 4725 3075 4250 2925
[106] 3550 3750 3900 3175 4775 3825 4600 3200 4275 3900 4075 2900 3775 3350 3325
[121] 3150 3500 3450 3875 3050 4000 3275 4300 3050 4000 3325 3500 3500 4475 3425
[136] 3900 3175 3975 3400 4250 3400 3475 3050 3725 3000 3650 4250 3475 3450 3750
[151] 3700 4000 4500 5700 4450 5700 5400 4550 4800 5200 4400 5150 4650 5550 4650
[166] 5850 4200 5850 4150 6300 4800 5350 5700 5000 4400 5050 5000 5100 4100 5650
[181] 4600 5550 5250 4700 5050 6050 5150 5400 4950 5250 4350 5350 3950 5700 4300
[196] 4750 5550 4900 4200 5400 5100 5300 4850 5300 4400 5000 4900 5050 4300 5000
[211] 4450 5550 4200 5300 4400 5650 4700 5700 4650 5800 4700 5550 4750 5000 5100
[226] 5200 4700 5800 4600 6000 4750 5950 4625 5450 4725 5350 4750 5600 4600 5300
[241] 4875 5550 4950 5400 4750 5650 4850 5200 4925 4875 4625 5250 4850 5600 4975
[256] 5500 4725 5500 4700 5500 4575 5500 5000 5950 4650 5500 4375 5850 4875 6000
[271] 4925   NA 4850 5750 5200 5400 3500 3900 3650 3525 3725 3950 3250 3750 4150
[286] 3700 3800 3775 3700 4050 3575 4050 3300 3700 3450 4400 3600 3400 2900 3800
[301] 3300 4150 3400 3800 3700 4550 3200 4300 3350 4100 3600 3900 3850 4800 2700
[316] 4500 3950 3650 3550 3500 3675 4450 3400 4300 3250 3675 3325 3950 3600 4050
[331] 3350 3450 3250 4050 3800 3525 3950 3650 3650 4000 3400 3775 4100 3775</code></pre>
</div>
<p>How can we describe these values?</p>
<div class="section level3">
<h3 id="mean">Mean<a class="anchor" aria-label="anchor" href="#mean"></a>
</h3>
<p>The mean is the average of all datapoints. We add all values
(excluding the missing values encoded with <code>NA</code>), and divide
with the number of observations:</p>
<p><span class="math display">\[\overline{x} = \frac{1}{N}\sum_1^N
x_i\]</span> Where N is the number of observations, and <span class="math inline">\(x_i\)</span> is the individual observations in the
sample <span class="math inline">\(x\)</span>.</p>
<p>The easiest way of getting the mean is using the <code>mean()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4201.754</code></pre>
</div>
<p>A slightly more cumbersome way is using the <code>summarise()</code>
function from <code>tidyverse</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>avg_mass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 1
  avg_mass
     &lt;dbl&gt;
1    4202.</code></pre>
</div>
<p>As we will see below, this function streamlines the process of
getting multiple descriptive values.</p>
<p>Barring significant outliers, <code>mean</code> is an expression of
position of the data. This is the weight we would expect a random
penguin in our dataset to have.</p>
<p>However, we have three different species of penguins in the dataset,
and they have quite different average weights. There is also a
significant difference in the average weight for the two sexes.</p>
<p>We will get to that at the end of this segment.</p>
</div>
<div class="section level3">
<h3 id="median">Median<a class="anchor" aria-label="anchor" href="#median"></a>
</h3>
<p>Similarly to the average/mean, the <code>median</code> is an
expression of the location of the data. If we order our data by size,
from the smallest to the largest value, and locate the middle
observation, we get the median. This is the value that half of the
observations is smaller than. And half the observations is larger.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">median</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4050</code></pre>
</div>
<p>We can note that the mean is larger than the median. This indicates
that the data is skewed, in this case toward the larger penguins.</p>
<p>We can get both <code>median</code> and <code>mean</code> in one go
using the <code>summarise()</code> function:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            mean   <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 2
  median  mean
   &lt;dbl&gt; &lt;dbl&gt;
1   4050 4202.</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="mode">Mode<a class="anchor" aria-label="anchor" href="#mode"></a>
</h3>
<p>Mode is the most common, or frequently occurring, observation. R does
not have a build-in function for this, but we can easily find the mode
by counting the different observations,and locating the most common
one.</p>
<p>We typically do not use this for continous variables. The mode of the
<code>sex</code> variable in this dataset can be found like this:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 √ó 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 male     168
2 female   165
3 &lt;NA&gt;      11</code></pre>
</div>
<p>We count the different values in the <code>sex</code> variable, and
arrange the counts in descending order (<code>desc</code>). The mode of
the <code>sex</code> variable is male.</p>
<p>In this specific case, we note that the dataset is pretty evenly
balanced regarding the two sexes.</p>
</div>
</section><section><h2 class="section-heading" id="measures-of-variance">Measures of variance<a class="anchor" aria-label="anchor" href="#measures-of-variance"></a>
</h2>
<hr class="half-width">
<p>Knowing where the observations are located is interesting. But how do
they vary? How can we describe the variation in the data?</p>
<div class="section level3">
<h3 id="range">Range<a class="anchor" aria-label="anchor" href="#range"></a>
</h3>
<p>The simplest information about the variation is the range. What is
the smallest and what is the largest value? Or, what is the spread?</p>
<p>We can get that by using the <code>min()</code> and
<code>max()</code> functions in a <code>summarise()</code> function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 2
    min   max
  &lt;int&gt; &lt;int&gt;
1  2700  6300</code></pre>
</div>
<p>There is a dedicated function, <code>range()</code>, that does the
same. However it returns two values (for each row), and the summarise
function expects to get <em>one</em> value.</p>
<p>If we would like to use the <code>range()</code> function, we can add
it using the <code>reframe()</code> function instead of
<code>summarise()</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">reframe</span><span class="op">(</span>range <span class="op">=</span> <span class="fu">range</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 √ó 1
  range
  &lt;int&gt;
1  2700
2  6300</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="variance">Variance<a class="anchor" aria-label="anchor" href="#variance"></a>
</h3>
<p>The observations varies. They are not all located at the mean (or
median), but are spread out on both sides of the mean. Can we get a
numerical value describing that?</p>
<p>An obvious way would be to calculate the difference between each of
the observations and the mean, and then take the average of those
differences.</p>
<p>That will give us the average deviation. But we have a problem. The
average weight of penguins was 4202 (rounded). Look at two penguins, one
weighing 5000, and another weighing 3425. The differences are:</p>
<ul>
<li>5000 - 4202 = 798</li>
<li>3425 - 4202 = -777</li>
</ul>
<p>The sum of those two differences is: -777 + 798 = 21 g. And the
average is then 10.5 gram. That is <em>not</em> a good estimate of a
variation from the mean of more than 700 gram.</p>
<p>The problem is, that the differences can be both positive and
negative, and might cancel each other out.</p>
<p>We solve that problem by squaring the differences, and calculate the
mean of those.</p>

<p>For the population variance, the mathematical notation would be:</p>
<p><span class="math display">\[
\sigma^2 = \frac{\sum_{i=1}^N(x_i - \mu)^2}{N}
\]</span></p>
<div id="population-or-sample" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="population-or-sample" class="callout-inner">
<h3 class="callout-title">Population or sample?</h3>
<div class="callout-content">
<p>Why are we suddenly using <span class="math inline">\(\mu\)</span>
instead of <span class="math inline">\(\overline{x}\)</span>? Because
this definition uses the population mean. The mean, or average, in the
entire population of all penguins everywhere in the universe. But we
have not weighed all those penguins.</p>
</div>
</div>
</div>
<p>And the sample variance:</p>
<p><span class="math display">\[
s^2 = \frac{\sum_{i=1}^N(x_i - \overline{x})^2}{N-1}
\]</span></p>
<p>Note that we also change the <span class="math inline">\(\sigma\)</span> to an <span class="math inline">\(s\)</span>.</p>
<p>And again we are not going to do that by hand, but will ask R to do
it for us:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            variance <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 1
  variance
     &lt;dbl&gt;
1  643131.</code></pre>
</div>

</div>
<div class="section level3">
<h3 id="standard-deviation">Standard deviation<a class="anchor" aria-label="anchor" href="#standard-deviation"></a>
</h3>
<p>There is a problem with the variance. It is 643131, completely off
scale from the actual values. There is also a problem with the unit
which is in <span class="math inline">\(g^2\)</span>.</p>
<p>A measurement of the variation of the data would be the standard
deviation, simply defined as the square root of the variance:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>            s <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 1
      s
  &lt;dbl&gt;
1  802.</code></pre>
</div>
<p>Since the standard deviation occurs in several statistical tests, it
is more frequently used than the variance. It is also more intuitively
relateable to the mean.</p>
</div>
</section><section><h2 class="section-heading" id="a-histogram">A histogram<a class="anchor" aria-label="anchor" href="#a-histogram"></a>
</h2>
<hr class="half-width">
<p>A visual illustration of the data can be nice. Often one of the first
we make, is a histogram.</p>
<p>A histogram is a plot or graph where we split the range of
observations in a number of ‚Äúbuckets‚Äù, and count the number of
observations in each bucket:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="op">!</span><span class="fu">is.na</span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>buckets <span class="op">=</span> <span class="fu">cut</span><span class="op">(</span><span class="va">body_mass_g</span>, breaks<span class="op">=</span><span class="fu">seq</span><span class="op">(</span><span class="fl">2500</span>,<span class="fl">6500</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">group_by</span><span class="op">(</span><span class="va">buckets</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summarise</span><span class="op">(</span>antal <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 √ó 2
  buckets         antal
  &lt;fct&gt;           &lt;int&gt;
1 (2.5e+03,3e+03]    11
2 (3e+03,3.5e+03]    67
3 (3.5e+03,4e+03]    92
4 (4e+03,4.5e+03]    57
5 (4.5e+03,5e+03]    54
6 (5e+03,5.5e+03]    33
7 (5.5e+03,6e+03]    26
8 (6e+03,6.5e+03]     2</code></pre>
</div>
<p>Typically, rather than counting ourself, we leave the work to R, and
make a histogram directly:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>By default ggplot chooses 30 bins, typically we should chose a
different number:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-change_bin_n-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Or, ideally, set the widths of them, manually:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">250</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with binwidth = 250 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-change_bin_width-1.png" style="display: block; margin: auto;" class="figure">
Or even specify the exact intervals we want, here intervals from 0 to
6500 gram in intervals of 250 gram:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">geom_histogram</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6500</span>,<span class="fl">250</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Histogram with bins in 250 g steps from 0 to 6500 g"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<p><img src="fig/descript-stat-rendered-bin_breaks-1.png" style="display: block; margin: auto;" class="figure">
The histogram provides us with a visual indication of both range, the
variation of the values, and an idea about where the data is
located.</p>
</section><section><h2 class="section-heading" id="quartiles">Quartiles<a class="anchor" aria-label="anchor" href="#quartiles"></a>
</h2>
<hr class="half-width">
<p>The median can be understood as splitting the data in two equally
sized parts, where one is characterized by having values smaller than
the median and the other as having values larger than the median. It is
the value where 50% of the observations are smaller.</p>
<p>Similary we can calculate the value where 25% of the observations are
smaller.</p>
<p>That is often called the first quartile, where the median is the 50%,
or second quartile. Quartile implies four parts, and the existence of a
third or 75% quartile.</p>
<p>We can calcultate those using the quantile function:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 25%
3550 </code></pre>
</div>
<p>and</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> 75%
4750 </code></pre>
</div>

<p>We are often interested in knowing the range in which 50% of the
observations fall.</p>
<p>That is used often enough that we have a dedicated function for
it:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 1
    iqr
  &lt;dbl&gt;
1  1200</code></pre>
</div>
<p>The name of the quantile function implies that we might have other
quantiles than quartiles. Actually we can calculate any quantile, eg the
2.5% quantile:</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">quantile</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.025</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    2.5%
2988.125 </code></pre>
</div>
<p>The individual quantiles can be interesting in themselves. If we want
a visual representation of <em>all</em> quantiles, we can calculate all
of them, and plot them.</p>
<p>Instead of doing that by hand, we can use a concept called
<em>CDF</em> or cumulative density function:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CDF</span> <span class="op">&lt;-</span> <span class="fu">ecdf</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span><span class="op">)</span></span>
<span><span class="va">CDF</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Empirical CDF
Call: ecdf(penguins$body_mass_g)
 x[1:94] =   2700,   2850,   2900,  ...,   6050,   6300</code></pre>
</div>
<p>That was not very informative. Lets plot it:</p>
<figure><img src="fig/descript-stat-rendered-cdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section><h2 class="section-heading" id="measures-of-shape">Measures of shape<a class="anchor" aria-label="anchor" href="#measures-of-shape"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="skewness">Skewness<a class="anchor" aria-label="anchor" href="#skewness"></a>
</h3>
<p>We previously saw a histogram of the data, and noted that the
observations were skewed to the left, and that the ‚Äútail‚Äù on the right
was longer than on the left. That skewness can be quantised.</p>
<p>There is no function for skewness build into R, but we can get it
from the library <code>e1071</code></p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="fu">skewness</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.4662117</code></pre>
</div>
<p>The skewness is positive, indicating that the data are skewed to the
left, just as we saw. A negative skewness would indicate that the data
skew to the right.</p>

</div>
<div class="section level3">
<h3 id="kurtosis">Kurtosis<a class="anchor" aria-label="anchor" href="#kurtosis"></a>
</h3>
<p>Another parameter describing the shape of the data is kurtosis. We
can think of that as either ‚Äúare there too many observations in the
tails?‚Äù leading to a relatively low peak. Or, as ‚Äúhow pointy is the
peak‚Äù - because the majority of observations are centered in the peak,
rather than appearing in the tails.</p>
<p>We use the <code>e1071</code> package again:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.73952</code></pre>
</div>
<p>Kurtosis is defined weirdly, and here we get ‚Äúexcess‚Äù kurtosis, the
actual kurtosis minus 3. We have negative kurtosis, indicating that the
peak is flat, and the tails are fat.</p>
</div>
</section><section><h2 class="section-heading" id="everything-everywhere-all-at-once">Everything Everywhere All at Once<a class="anchor" aria-label="anchor" href="#everything-everywhere-all-at-once"></a>
</h2>
<hr class="half-width">
<p>A lot of these descriptive values can be gotten for every variable in
the dataset using the <code>summary</code> function:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>      species          island    bill_length_mm  bill_depth_mm
 Adelie   :152   Biscoe   :168   Min.   :32.10   Min.   :13.10
 Chinstrap: 68   Dream    :124   1st Qu.:39.23   1st Qu.:15.60
 Gentoo   :124   Torgersen: 52   Median :44.45   Median :17.30
                                 Mean   :43.92   Mean   :17.15
                                 3rd Qu.:48.50   3rd Qu.:18.70
                                 Max.   :59.60   Max.   :21.50
                                 NA's   :2       NA's   :2
 flipper_length_mm  body_mass_g       sex           year
 Min.   :172.0     Min.   :2700   female:165   Min.   :2007
 1st Qu.:190.0     1st Qu.:3550   male  :168   1st Qu.:2007
 Median :197.0     Median :4050   NA's  : 11   Median :2008
 Mean   :200.9     Mean   :4202                Mean   :2008
 3rd Qu.:213.0     3rd Qu.:4750                3rd Qu.:2009
 Max.   :231.0     Max.   :6300                Max.   :2009
 NA's   :2         NA's   :2                                 </code></pre>
</div>
<p>Here we get the range, the 1st and 3rd quantiles (and from those the
IQR), the median and the mean and, rather useful, the number of missing
values in each variable.</p>
<p>We can also get all the descriptive values in one table, by adding
more than one summarizing function to the summarise function:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            var <span class="op">=</span> <span class="fu">var</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q1 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.25</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            Q3 <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">body_mass_g</span>, probs <span class="op">=</span> <span class="fl">.75</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            iqr <span class="op">=</span> <span class="fu">IQR</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            skew <span class="op">=</span> <span class="fu">skewness</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            kurtosis <span class="op">=</span> <span class="fu">kurtosis</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 1 √ó 11
    min   max  mean median stddev     var    Q1    Q3   iqr  skew kurtosis
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1  2700  6300 4202.   4050   802. 643131.  3550  4750  1200 0.466   -0.740</code></pre>
</div>
<p>As noted, we have three different species of penguins in the dataset.
Their weight varies a lot. If we want to do the summarising on each for
the species, we can group the data by species, before summarising:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>min <span class="op">=</span> <span class="fu">min</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            max <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            mean <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu">median</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>            stddev <span class="op">=</span> <span class="fu">sd</span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 √ó 6
  species     min   max  mean median stddev
  &lt;fct&gt;     &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 Adelie     2850  4775 3701.   3700   459.
2 Chinstrap  2700  4800 3733.   3700   384.
3 Gentoo     3950  6300 5076.   5000   504.</code></pre>
</div>
<p>We have removed some summary statistics in order to get a smaller
table.</p>
</section><section><h2 class="section-heading" id="boxplots">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<hr class="half-width">
<p>Finally boxplots offers a way of visualising some of the summary
statistics:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">body_mass_g</span>, y <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<figure><img src="fig/descript-stat-rendered-boxplots-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The boxplot shows us the median (the fat line in the middel of each
box), the 1st and 3rd quartiles (the ends of the boxes), and the range,
with the whiskers at each end of the boxes, illustrating the minimum and
maximum. Any observations, more than 1.5 times the IQR from either the
1st or 3rd quartiles, are deemed as outliers and would be plotted as
individual points in the plot.</p>
</section><section><h2 class="section-heading" id="counting">Counting<a class="anchor" aria-label="anchor" href="#counting"></a>
</h2>
<hr class="half-width">
<p>Most of the descriptive functions above are focused on continuous
variables, maybe grouped by one or more categorical variables.</p>
<p>What about the categorical themselves?</p>
<p>The one thing we can do looking only at categorical variables, is
counting.</p>
<p>Counting the different values in a single categorical variable in
base-R is done using the <code>table(()</code> function</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
female   male
   165    168 </code></pre>
</div>
<p>Often we are interested in cross tables, tables where we count the
different combinations of the values in more than one categorical
variable, eg the distribution of the two different penguin sexes on the
three different islands:</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">island</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
            female male
  Biscoe        80   83
  Dream         61   62
  Torgersen     24   23</code></pre>
</div>
<p>We can event group on three (or more) categorical variables, but the
output becomes increasingly difficult to read the mote variables we
add:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">island</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">sex</span>, <span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>, ,  = Adelie


            female male
  Biscoe        22   22
  Dream         27   28
  Torgersen     24   23

, ,  = Chinstrap


            female male
  Biscoe         0    0
  Dream         34   34
  Torgersen      0    0

, ,  = Gentoo


            female male
  Biscoe        58   61
  Dream          0    0
  Torgersen      0    0</code></pre>
</div>
</section><section><h2 class="section-heading" id="aggregate">Aggregate<a class="anchor" aria-label="anchor" href="#aggregate"></a>
</h2>
<hr class="half-width">
<p>A different way of doing that in base-R is using the
<code>aggregate()</code> function:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">aggregate</span><span class="op">(</span><span class="va">sex</span> <span class="op">~</span> <span class="va">island</span>, data <span class="op">=</span> <span class="va">penguins</span>, FUN <span class="op">=</span> <span class="va">length</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     island sex
1    Biscoe 163
2     Dream 123
3 Torgersen  47</code></pre>
</div>
<p>Here we construct the crosstable using the formula notation, and
specify which function we want to apply on the results. This can be used
to calculate summary statistics on groups, by adjusting the
<code>FUN</code> argument.</p>
</section><section><h2 class="section-heading" id="counting-in-tidyverse">Counting in tidyverse<a class="anchor" aria-label="anchor" href="#counting-in-tidyverse"></a>
</h2>
<hr class="half-width">
<p>In tidyverse we will typically group the data by the variables we
want to count, and then tallying them:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 3 √ó 2
  sex        n
  &lt;fct&gt;  &lt;int&gt;
1 female   165
2 male     168
3 &lt;NA&gt;      11</code></pre>
</div>
<p><code>group_by</code> works equally well with more than one
group:</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tally</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 √ó 3
# Groups:   sex [3]
  sex    species       n
  &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;
1 female Adelie       73
2 female Chinstrap    34
3 female Gentoo       58
4 male   Adelie       73
5 male   Chinstrap    34
6 male   Gentoo       61
7 &lt;NA&gt;   Adelie        6
8 &lt;NA&gt;   Gentoo        5</code></pre>
</div>
<p>But the output is in a long format, and often requires some
manipulation to get into a wider tabular format.</p>
<p>A shortcut exists in tidyverse, <code>count</code>, which combines
group_by and tally:</p>
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 8 √ó 3
  sex    species       n
  &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;
1 female Adelie       73
2 female Chinstrap    34
3 female Gentoo       58
4 male   Adelie       73
5 male   Chinstrap    34
6 male   Gentoo       61
7 &lt;NA&gt;   Adelie        6
8 &lt;NA&gt;   Gentoo        5</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We have access to a lot of summarising descriptive indicators the
the location, spread and shape of our data.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-tidy-data"><p>Content from <a href="tidy-data.html">Tidy Data</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/tidy-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we structure our data best?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what tidy data is</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Most of what we want to do with our data is relatively simple.
<em>If</em> the data is structured in the right way.</p>
<p>Working within the paradigm of <code>tidyverse</code> it is
preferable if the data is <em>tidy</em>.</p>
<figure><img src="fig/tidy_why.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data is not the opposite of messy data. Data can be nice and
well structured, tidy as in non-messy, without being tidy in the way we
understand it in this context.</p>
<figure><img src="fig/tidy_hadley_2.jpg" alt="" class="figure mx-auto d-block"></figure><p>Tidy data in the world of R, especially the dialect of R we call
tidyverse, are characterized by:</p>
<ul>
<li>Each variable is a column; each column is a variable.</li>
<li>Each observation is a row; each row is an observation.</li>
<li>Each value is a cell; each cell is a single value.</li>
</ul>
<figure><img src="fig/tidy_hadley.jpg" alt="" class="figure mx-auto d-block"></figure><p>This way of structuring our data is useful not only in R, but also in
other software packages.</p>
</section><section><h2 class="section-heading" id="an-examples">An examples<a class="anchor" aria-label="anchor" href="#an-examples"></a>
</h2>
<hr class="half-width">
<p>This is an example of untidy data, on new cases of tubercolosis in
Afghanistan. It is well structured, however there are information in the
column names.</p>
<p>‚Äúnew_sp_m014‚Äù describes ‚Äúnew‚Äù cases. Diagnosed with the ‚Äúsp‚Äù method
(culturing a sample of sputum and identifying the presence of
Mycobacterium Tuberculosis bacteria). In ‚Äúm‚Äù meaning males, between the
ages of 0 and 14.</p>
<p>Picking out information on all new cases eg. distribution between the
two sexes is difficult. Similar problems arise if we want to follow the
total number of new cases.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 √ó 6
   country      year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544
   &lt;chr&gt;       &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
 1 Afghanistan  2000          52          228          183          149
 2 Afghanistan  2001         129          379          349          274
 3 Afghanistan  2002          90          476          481          368
 4 Afghanistan  2003         127          511          436          284
 5 Afghanistan  2004         139          537          568          360
 6 Afghanistan  2005         151          606          560          472
 7 Afghanistan  2006         193          837          791          574
 8 Afghanistan  2007         186          856          840          597
 9 Afghanistan  2008         187          941          773          545
10 Afghanistan  2009         200          906          705          499</code></pre>
</div>
<p>Getting this data on a tidy format is not trivial, but a resulting,
tidy, organised dataset would look something like this:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 40 √ó 7
   country      year new   method sex   age_group cases
   &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
 1 Afghanistan  2000 new   sp     m     0-14         52
 2 Afghanistan  2000 new   sp     m     15-24       228
 3 Afghanistan  2000 new   sp     m     25-34       183
 4 Afghanistan  2000 new   sp     m     35-44       149
 5 Afghanistan  2001 new   sp     m     0-14        129
 6 Afghanistan  2001 new   sp     m     15-24       379
 7 Afghanistan  2001 new   sp     m     25-34       349
 8 Afghanistan  2001 new   sp     m     35-44       274
 9 Afghanistan  2002 new   sp     m     0-14         90
10 Afghanistan  2002 new   sp     m     15-24       476
# ‚Ñπ 30 more rows</code></pre>
</div>
<p>The fact that we are recording ‚Äúnew‚Äù cases is now a variable in it
self. The method used is also a variable, and the categorical variabel
sex is similarly a separate variable as is the age group.</p>
<p>The variables <code>new</code>, <code>method</code> and
<code>sex</code> might appear redundant - all values are identical,
however the entire dataset contains data on non-new cases, other methods
for diagnosis and the other sex, recorded as ‚Äúf‚Äù.</p>
</section><section><h2 class="section-heading" id="dos-and-donts-in-excel">Do‚Äôs and dont‚Äôs in Excel<a class="anchor" aria-label="anchor" href="#dos-and-donts-in-excel"></a>
</h2>
<hr class="half-width">
<p>Excel is a very useful tool, especially for collecting data.</p>
<p>But even though we are able to do everything we can do in R, in
Excel, we will normally do the main part of our work with data in R.</p>
<p>It is therefor a very good idea to think about how we collect and
organise the data in Excel, to make our life easier later on.</p>
<p>We have collected some good rules of thumb for structuring data in
Excel, based on time-consuming and traumatic experiences wrangling data
from Excel to R.</p>
<p><strong>Always</strong></p>
<ul>
<li>Use one column for one variable</li>
<li>Use one row for one observation</li>
<li>Use one cell for one value</li>
<li>Begin your data in the upper left corner (cell A1)</li>
<li>Use one sheet for each type of data</li>
</ul>
<p><strong>Never (EVER!)</strong></p>
<ul>
<li>Modify your raw data - always make a copy before making any
change</li>
<li>Merge cells</li>
<li>Use colours for information</li>
</ul>
<p>Illustrations from the Openscapes blog Tidy Data for reproducibility,
efficiency, and collaboration by Julia Lowndes and Allison Horst</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>tidy data provides a consistent way of organizing data</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-normal-distribution"><p>Content from <a href="normal-distribution.html">The normal distribution</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/normal-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What even is a normal distribution?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
<li>Demonstrate how to include pieces of code, figures, and nested
challenge blocks</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-the-normal-distribution">What is the normal distribution<a class="anchor" aria-label="anchor" href="#what-is-the-normal-distribution"></a>
</h2>
<hr class="half-width">
<p>A probability distribution is a mathematical function, that describes
the likelihood of different outcomes in a random experiment. It gives us
probabilities for all possible outcomes, and is normalised so that the
sum of all the probabilities is 1.</p>
<figure><img src="fig/normal-distribution-rendered-4-distibutions-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Probability distributions can be discrete, or they can be continuous.
The normal distribution is just one of several different continuous
probability distributions.</p>
<p>The normal distribution is especially important, for a number of
reasons:</p>
<ol style="list-style-type: decimal">
<li><p>If we take a lot of samples from a population and calculate the
averages of a given variable in those samples, the averages, or means
will be normally distributed. This is know as the <a href="CLT-en.html">Central Limit Theorem</a>.</p></li>
<li><p>Many natural (and human made) processes follow a normal
distribution.</p></li>
<li><p>The normal distribution have useful mathematical properties. It
might not appear to be simple working with the normal distribution. But
the alternative is worse.</p></li>
<li><p>Many statistical methods and tests are based on assumptions of
normality.</p></li>
</ol></section><section><h2 class="section-heading" id="how-does-it-look---mathematically">How does it look - mathematically?<a class="anchor" aria-label="anchor" href="#how-does-it-look---mathematically"></a>
</h2>
<hr class="half-width">
<p>The normal distribution follows this formula:</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
\]</span></p>
<p>If a variable in our population is normally distributed, have a mean
<span class="math inline">\(\mu\)</span> and a standard deviation <span class="math inline">\(\sigma\)</span>, we can find the probability of
observing the value <span class="math inline">\(x\)</span> of the
varibel by plugging in the values, and calculate <span class="math inline">\(f(x)\)</span>.</p>
<p>Note that we are here working with the population mean and standard
deviation. Those are the ‚Äútrue‚Äù mean and standard deviation for the
<em>entire</em> universe. That is signified by using the greek letters
<span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. In practise we do not know what
those true values are.</p>
<div id="what-does-it-mean-that-our-data-is-normally-distributed" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="what-does-it-mean-that-our-data-is-normally-distributed" class="callout-inner">
<h3 class="callout-title">What does it mean that our data is normally distributed</h3>
<div class="callout-content">
<p>We have an entire section on that - but in short: The probabilities
we get from the formula above should match the frequencies we observe in
our data.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="how-does-it-look--graphically">How does it look- graphically?<a class="anchor" aria-label="anchor" href="#how-does-it-look--graphically"></a>
</h2>
<hr class="half-width">
<p>It is useful to be able to compare the distributions of different
variables. That can be difficult if one have a mean of 1000, and the
other have a mean of 2. Therefore we often work with standardized normal
distributions, where we transform the data to have a mean of 0 and a
standard deviation of 1. So let us look at the standardized normal
distribution.</p>
<p>If we plot it, it looks like this:</p>
<p><img src="fig/The_Normal_Distribution.svg" alt="The Normal Distribution." class="figure"> The area under the curve is 1,
equivalent to 100%.</p>
<p>The normal distribution have a lot of nice mathematical properties,
some of which are indicated on the graph.</p>
</section><section><h2 class="section-heading" id="so---what-is-the-probability">So - what <em>is</em> the probability?<a class="anchor" aria-label="anchor" href="#so---what-is-the-probability"></a>
</h2>
<hr class="half-width">
<p>The normal distribution curve tell what the probability density for a
given observation is. But in general we are interested in the
probability that something is larger, or smaller, than something. Or
between certain values.</p>
<p>Rather that plotting the probability density, we can plot the
cumulative density.</p>
<figure><img src="fig/normal-distribution-rendered-cdf-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that we also find the cumulitive probability in the original
plot of the normal distribution - now it is a bit more direct.</p>
<p>This allow us to see that the probability of observing a value that
is 2 standard deviations smaller than the mean is rather small.</p>
<p>We can also, more indirectly, note that the probability of observing
a value that is 2 standard deviations larger than the mean is rather
small. Note that the probability of an observation that is smaller than
2 standard deviations larger than the mean is 97.7% (hard to read on the
graph, but we will get to that). Since the total probability is 100%,
the probability of an observation being larger than 2 standard
deviations is 100 - 97.7 = 2.3%</p>
</section><section><h2 class="section-heading" id="do-not-read-the-graph---do-the-calculation">Do not read the graph - do the calculation<a class="anchor" aria-label="anchor" href="#do-not-read-the-graph---do-the-calculation"></a>
</h2>
<hr class="half-width">
<p>Instead of trying to measure the values on the graph, we can do the
calculations directly.</p>
<p>R provides us with a set of functions:</p>
<ul>
<li>
<em>pnorm</em> returns the probability of having a smaller value
than x</li>
<li>
<em>qnorm</em> the value x corresponding to a given probability</li>
<li>
<em>dnorm</em> returns the probability density of the normal
distribution at a given x.</li>
</ul>
<p>We have an additional <em>rnorm</em> that returns a random value,
drawn from a normal distribution.</p>
<div id="try-it-your-self" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="try-it-your-self" class="callout-inner">
<h3 class="callout-title">Try it your self!</h3>
<div class="callout-content">
<p>Assuming that our observations are normally distributed with a mean
of 0 and a standard deviation of 1.</p>
<p>What is the probability of an observation x &lt; 2?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.9772499</code></pre>
</div>
<p>About 98% of the observations are smaller than 2</p>
</div>
</div>
</div>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Making the same assumptions, what is the value of the observation,
for which 42% of the observations is smaller?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qnorm</span><span class="op">(</span><span class="fl">0.42</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.2018935</code></pre>
</div>
<p>42% of the observations are smaller than -0.2</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="what-about-other-means-and-standard-deviations">What about other means and standard deviations?<a class="anchor" aria-label="anchor" href="#what-about-other-means-and-standard-deviations"></a>
</h2>
<hr class="half-width">
<p>Being able to find out what the probablity of some observation being
smaller when the mean is 0 and the standard deviation is 1, is nice. But
this is not a common problem.</p>
<p>Rather we might know that adult men in a given country have an
average height of 183 cm, and that the standard deviation of their
height is 9.7 cm.</p>
<p>What is the probability to encounter a man that is taller than 2
meters?</p>
<p>The R-functions handle this easily, we ‚Äúsimply‚Äù specify the mean and
standard deviation in the function:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
<p>The function calculate the probability of a man being shorter than
200 cm, if the distribution is normal and the mean and standard devation
is 183 and 9.7 respectively. The probability of the man having a height
is 1 (equivalent to 100%). So if the probability of the man being
shorter than 200 cm is 96%, the probability of him being taller than 200
cm is 4%</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> How does that work? </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>We have a lot of men with an average height of 183. They all have an
individual heigth. If we subtract 183 from their height, and use that as
a measurement of their height, that will have a mean of 0.</p>
<p>We are not going into the details, but if we divide all the heights
with the original standard deviation, and do all the math, we will
discover that the standard deviation of the new heights will be 1.</p>
<p>Therefore, if we subtract 183 from all the individual heights, and
divide them by 9.7, the resulting measurements of the heights have a
mean of 0 and a standard deviation of 1. Bringing all that together, we
get:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="op">(</span><span class="fl">200</span><span class="op">-</span><span class="fl">183</span><span class="op">)</span><span class="op">/</span><span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.03983729</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="how-many-men-are-in-an-interval" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-many-men-are-in-an-interval" class="callout-inner">
<h3 class="callout-title">How many men are in an interval?</h3>
<div class="callout-content">
<p>How many men have a height between 170 and 190 cm?</p>
<p>Assume mean = 183 cm and sd = 9.7</p>
</div>
</div>
</div>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div> Hint </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" aria-labelledby="headingSpoiler2" data-bs-parent="#accordionSpoiler2">
<div class="accordion-body">
<p>What proportion of men are shorter than 190 cm? And what proportion
of men are shorter than 170 cm?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">190</span>, mean <span class="op">=</span><span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span> <span class="op">)</span>  <span class="op">-</span> <span class="fu">pnorm</span><span class="op">(</span><span class="fl">170</span>, mean <span class="op">=</span> <span class="fl">183</span>, sd <span class="op">=</span> <span class="fl">9.7</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.6746558</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="clt">CLT<a class="anchor" aria-label="anchor" href="#clt"></a>
</h2>
<hr class="half-width">
<p>But my data is not normally distributed?</p>
<p>No, it is not. Actually most data is not normally distributed. Often
it <em>cannot</em> be normally distributed. Serum molybdenum, an
essential trace metal in human physiology has a mean of 1.55 and a
standard deviation of 0.74 in normal healthy adult humans.</p>
<div id="how-many-danes-have-negative-serum-molybdenum" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-many-danes-have-negative-serum-molybdenum" class="callout-inner">
<h3 class="callout-title">How many danes have negative serum molybdenum?</h3>
<div class="callout-content">
<p>Assuming an adult population of 5000000 danes, a mean of 1.55 and a
standard deviation of 0.74, how many danes have a negative concentration
of Molybdenum (Mo) in their blood?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>We begin by calculating the probability of observing a Mo
concentration lower than 0:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pnorm</span><span class="op">(</span><span class="fl">0</span>, mean <span class="op">=</span> <span class="fl">1.55</span>, sd <span class="op">=</span> <span class="fl">0.74</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01810352</code></pre>
</div>
<p>We then multiply by the number of people:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5000000</span><span class="op">*</span><span class="fl">0.01810352</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 90517.6</code></pre>
</div>
<p>About 90000 adult danes have not only none, but actually negative
amounts of Molybdenum in their blood. Which is impossible.</p>
</div>
</div>
</div>
</div>
<p>So - your data is not normally distributed. But the properties of
your samples are!</p>
<p>We are not actually measuring the average height of all men in the
world ever. We are taking a sample, and calculating the mean. And
standard deviation. And proportion.</p>
<p>And those, the mean etc, <em>are</em> normally distributed, even if
the underlying distribution of the population is not.</p>
<p>The Central Limit Theorem allow us to assume that, if we take enough
random samples, the mean and standard deviation of these samples, will
be normally distributed.</p>
<p>This is what we use when doing statistical tests. We posit a
null-hypothesis that the ‚Äútrue‚Äù mean of some value should be something.
We take a sample, and calculate the mean. And using the normal
distribution, we can look at the CDF-plot above, and determine the
probability of seeing the value we get.</p>
<p>In practice we are usually not using the normal distribution, buth
rather the t-distribution, to correct for the fact that we do not
actually know the true mean and varians/standard deviation of the
population. It gives us a more conservative estimate taht is more likely
to be ‚Äútrue‚Äù.</p>
<div id="what-is-normal" class="callout testimonial">
<div class="callout-square">
<i class="callout-icon" data-feather="heart"></i>
</div>
<div id="what-is-normal" class="callout-inner">
<h3 class="callout-title">What is normal?</h3>
<div class="callout-content">
<p>The normal distribution is normal, because Karl Pearson and Francis
Galton in the 19th century took a lot of samples of different
phenomenons in the population data. Height, weight, intelligence etc.
Calculating the mean (and other descriptive statistical parameters) they
noted that these means followed a specific distribution. This was not
the case for every phenomenon. But for a lot.</p>
<p>Looking at the distributions describing a lot of phenomenons, the
most common was one specific distribution.</p>
<p>In descriptive statistics, the normal observation is simply the most
frequent. In this set of numbers:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5 5</code></pre>
</div>
<p>5 is the normal observation - because it is the most frequent, even
if it only represents 20% of the observations. In a statistical sense
normal is not normative. The normal colour eye among humans is brown.
Not because there is anything wrong with other colours, but simply
because brown is the most frequent.</p>
<p>The most frequent, ie normal, distribution found, was named the
normal distribution.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-is-it-normal"><p>Content from <a href="is-it-normal.html">Testing for normality</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/is-it-normal.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we determine if a dataset might be normally distributed?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use markdown with the new lesson template</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span></code></pre>
</div>
<section><h2 class="section-heading" id="how-to-test-if-our-data-is-normally-distributed">How to test if our data is normally distributed?<a class="anchor" aria-label="anchor" href="#how-to-test-if-our-data-is-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Common question - is my data normally distributed?</p>
<p>What does it mean that it is normally distributed? It means that the
distribution of our data has the same properties as the normal
distribution.</p>
<p>Let us get some data that we can test:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Chinstrap"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="mean-and-median">Mean and median<a class="anchor" aria-label="anchor" href="#mean-and-median"></a>
</h3>
<p>One of the properties of the normal distribution is that the mean and
median of the data is equal. Let us look at the penguins:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> bill_depth_mm
 Min.   :16.40
 1st Qu.:17.50
 Median :18.45
 Mean   :18.42
 3rd Qu.:19.40
 Max.   :20.80  </code></pre>
</div>
<p>This is actually pretty close! But equality between median and mean
is a neccesary, not a sufficient condition.</p>
<p>What next. A histogram of the data should look normal. Let us take a
closer look at bill_depth_mm where mean and median are closest:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-histogram-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This does not really look like a normal distribution. The fact that
mean and median are almost identical was not a sufficient criterium for
normalcy.</p>
<p>The shape of a histogram is heavily dependent on the bins we choose.
A better way of visualizing often density-plots:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-densityplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can think of this as a histogram with infinitely small bins.</p>
<p>This does look more normal - but it would be nice to be able to
quantize the degree of normalcy.</p>
</div>
</section><section><h2 class="section-heading" id="percentiels-and-qq-plots-as-a-test">Percentiels and QQ-plots as a test<a class="anchor" aria-label="anchor" href="#percentiels-and-qq-plots-as-a-test"></a>
</h2>
<hr class="half-width">
<p>The properties of the normal distribution informs us that 50% of the
observations in the data are smaller than the mean (and conversely 50%
are larger). We alson know that 50% of the observations should be in the
interquartile range. And what we also know is that 2.5% of the
observations (the 2.5 percentile) are smaller than the mean minus 1.96
times the standard deviation.</p>
<p>Actually we can calculate exactly which percentile a given
observation is in. And we we can calculate which value a given
percentile should have.</p>
<p>Comparing those gives us an indication of how well the data conforms
to a normal distribution.</p>
<p>Rather than doing that by hand, we can get R to do it for us in a
nice graphical way:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normal_test_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">bill_depth_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_qq_line</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/is-it-normal-rendered-qq-plot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The <code>geom_qq</code> function calculate and plots which
percentile an observation is in.</p>
<p>Rather than being given percentiles, we are given the value that the
percentile corresponds to if we calculate it as number of standard
deviations from the mean.</p>
<p>This results in plots that are more comparable.</p>
<p><code>geom_qq_line</code> plots the line corresponding til the values
the percentiles should have, if the data was normally distributed.</p>
<p>A common theme is that the midle of the data falls relatively close
to the line, and that there are deviations from the line at both ends.
In this case the deviations are largish, indicating that the data is not
normally distributed.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>We have two tails in the qq-plot, a left and a right. And they can be
either above or below the qq-line.</p>
<p>That results in four different cases, that informs us about what is
wrong with the data - in regards to how it deviates from normalcy.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="15%">
<col width="15%">
<col width="54%">
</colgroup>
<thead><tr class="header">
<th>Left tail</th>
<th>Right tail</th>
<th>Name</th>
<th>What</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Above</td>
<td>Below</td>
<td>Leptokurtic</td>
<td>Heavier tails - ie. more extreme values. Higher kurtosis</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Above</td>
<td>Platykurtic</td>
<td>Lighter tails - ie. fewer extreme values. Lower kurtosis</td>
</tr>
<tr class="odd">
<td>Above</td>
<td>Above</td>
<td>Right skewed</td>
<td>A tail that stretches to the higher values - the extreme values are
larger.</td>
</tr>
<tr class="even">
<td>Below</td>
<td>Below</td>
<td>Left skewed</td>
<td>A tail that stretches to the lower values - the extreme values are
smaller.</td>
</tr>
</tbody>
</table>
<figure><img src="fig/is-it-normal-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="numerical-measures-rather-than-graphical">Numerical measures rather than graphical<a class="anchor" aria-label="anchor" href="#numerical-measures-rather-than-graphical"></a>
</h2>
<hr class="half-width">
<p>With experience the qq-plots can be used to determine if the data is
normally distributed - the points are exactly on the line. But only
rarely the points matches exactly - even if the data is normally
distributed <em>enough</em>. And how much can the tails deviate from the
line before the data is not normally distributed <em>enough</em>?</p>
<p>The deviations can be described numerically using two parameters:</p>
<p>Kurtosis and skewness.</p>
<p>Base-R do not have functions for this, but the package
<code>e1071</code> does.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">skewness</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.006578141</code></pre>
</div>
<p>kurtosis</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kurtosis</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -0.960087</code></pre>
</div>
<p>As a rule of thumb, skewness should be within +/-0.5 if the data is
normally distributed. Values between +/-0.5 and +/- 1 indicates a
moderate skewness, where data <em>can</em> still be approximately
normally distributed. Values larger that +/-1 indicates a significant
skewness, and the data is probably not normally distributed.</p>
<p>For the kurtosis matters are a bit more complicated as the kurtosis
for a normal distribution is 3. We therefore look at excess kurtosis,
where i subtract 3 from the calculated kurtosis. An value of +/-1 exces
kurtosis indicates that the data has a ‚Äòtailedness‚Äô close to the normal
distribution. Values between +/-1 and +/-2 indicates a moderate
deviation from the normal distribution, but the data can still be
approximately normally distributed. Values larger than +/-2 is in
general taken as an indication that the data is not normally
distributed.</p>
<p>The absolute value of the excess kurtosis is larger than 2,
indicating that the data is not normally distributed.</p>
</section><section><h2 class="section-heading" id="more-direct-tests">More direct tests<a class="anchor" aria-label="anchor" href="#more-direct-tests"></a>
</h2>
<hr class="half-width">
<p>The question of wether or not data is normally distributed is
important in many contexts, and it should come as no surprise that a
multitude of tests has been devised for testing exactly that.</p>

<div class="section level3">
<h3 id="shapiro-wilk">Shapiro-Wilk<a class="anchor" aria-label="anchor" href="#shapiro-wilk"></a>
</h3>
<p>The Shapiro-Wilk test is especially suited for small sample sizes
(&lt;50, some claim it works well up to &lt;2000).</p>
<p>It is a measure of the linear correlation between data and the
normally distributed quantiles, what we see in the qqplot.</p>
<p>The null-hypothesis is that data is normally distributed, and the
Shapiro-Wilk test returns a p-value reporting the risk of being wrong if
we reject the null-hypothesis.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">shapiro.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Shapiro-Wilk normality test

data:  normal_test_data$bill_depth_mm
W = 0.97274, p-value = 0.1418</code></pre>
</div>
<p>The p-value in this case is 0.1418 - and we do not have enough
evidense to reject the null-hypothesis. The data is probably normally
distributed.</p>
</div>
<div class="section level3">
<h3 id="kolmogorov-smirnov">Kolmogorov-Smirnov<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov"></a>
</h3>
<p>The KS-test allows us to test if the data is distributed as a lot of
different distributions, not only the normal distribution. Because of
this, we need to specify the specific distribution we are testing for,
in this case a normal distribution with specific values for mean and
standard deviation.</p>
<p>Therefore we need to calculate those:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">ks.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span>, <span class="st">"pnorm"</span>, mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning in ks.test.default(normal_test_data$bill_depth_mm, "pnorm", mean =
mean, : ties should not be present for the one-sample Kolmogorov-Smirnov test</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Asymptotic one-sample Kolmogorov-Smirnov test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.8565
alternative hypothesis: two-sided</code></pre>
</div>
<p>In this test the null-hypothesis is also that data is normally
distributed. The p-values is very high, and therefore we cannot reject
the null-hypothesis. Again, this is not the same as the data
<em>actually</em> being normally distributed.</p>
<p>This test assumes that there are no repeated values in the data, as
that can affect the precision of the test. The p-value is still very
high, and we will conclude that we cannot rule out that the data is not
normally distributed.</p>
<p>Note that the KS-test assumes that we actually know the true mean and
standard deviation. Here we calculate those values based on the sample,
which is problematic.</p>
</div>
<div class="section level3">
<h3 id="liliefors-test">Liliefors test<a class="anchor" aria-label="anchor" href="#liliefors-test"></a>
</h3>
<p>This is a variation on the KS-test, that is designed specifically for
testing for normality. It does not require us to know the true mean and
standard deviation for the population.</p>
<p>This test is also not available in base-R, but can be found in the
<code>nortest</code> package:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span></span>
<span><span class="fu">lillie.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Lilliefors (Kolmogorov-Smirnov) normality test

data:  normal_test_data$bill_depth_mm
D = 0.073463, p-value = 0.483</code></pre>
</div>
<p>Again the p-value is so high, that we cannot reject the
null-hypothesis.</p>
</div>
<div class="section level3">
<h3 id="anderson-darling-test">Anderson-Darling test<a class="anchor" aria-label="anchor" href="#anderson-darling-test"></a>
</h3>
<p>This test is more sensitive for deviations in the tails.</p>
<p>It is not available in base-R, but can be found in the
<code>nortest</code> package.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ad.test</span><span class="op">(</span><span class="va">normal_test_data</span><span class="op">$</span><span class="va">bill_depth_mm</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
	Anderson-Darling normality test

data:  normal_test_data$bill_depth_mm
A = 0.44788, p-value = 0.2714</code></pre>
</div>
<p>In this case the null-hypothesis is also that data is normally
distributed, and the p-value indicates that we cannot reject the
null-hypothesis.</p>
</div>
</section><section><h2 class="section-heading" id="and-is-it-actually-normally-distributed">And is it actually normally distributed?<a class="anchor" aria-label="anchor" href="#and-is-it-actually-normally-distributed"></a>
</h2>
<hr class="half-width">
<p>Probably not. Except for the excess kurtosis all the tests we have
done indicate that the depth of the beaks of chinstrap penguins can be
normally distributed. Or rather, that we cannot reject the
null-hypothesis that they are normally distributed.</p>
<p>But the fact that we cannot reject this hypothesis is not the same as
concluding that the data actually <strong>is</strong> normally
distributed.</p>
<p>Based on the excess kurtosis and the qq-plot, it would be reasonable
to conclude that it is not.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>.md</code> files for episodes when you want static
content</li>
<li>Use <code>.Rmd</code> files for episodes when you need to generate
output</li>
<li>Run <code>sandpaper::check_lesson()</code> to identify any issues
with your lesson</li>
<li>Run <code>sandpaper::build_lesson()</code> to preview your lesson
locally</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-which-distribution"><p>Content from <a href="which-distribution.html">How is the data distributed?</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/which-distribution.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>If my data is not normally distributed - which distribution does it
actually follow?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how to identify possible distributions describing the data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Your data was not normally distributed. Now what?</p>
<p>The process generating your data is probably following some
distribution. The size distribution of cities appears to follow a Pareto
distibution, as is wealth. The number of mutations in a string of DNA
appears to follow a poisson distribution. And the distribution of wind
speeds as well as times to failure for technical components both follow
the Weibull distribution.</p>
<p>If you have a theoretical foundation for which distribution you data
generating function follows, that is nice.</p>
<p>If you do not - we will be interested in figuring out which
distribution your data actually follow.</p>
</section><section><h2 class="section-heading" id="how">How?<a class="anchor" aria-label="anchor" href="#how"></a>
</h2>
<hr class="half-width">
<p>We fit our data to a distribution. Or rather - we fit the data to
several different distributions and then choose the best.</p>
<p>Let us look at some data. The <code>faithful</code> data set contains
272 observations of the Old Faithful geyser in Yellowstone National Park
in USA. We only look at eruptions that lasts longer than 3 minutes:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="va">eruption_example</span> <span class="op">&lt;-</span> <span class="va">faithful</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">eruptions</span><span class="op">)</span></span></code></pre>
</div>

<p>Rather than testing a lot of different distributions, we can use the
<code>gamlss</code> package, and two add-ons to that.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.dist</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">gamlss.add</span><span class="op">)</span></span></code></pre>
</div>
<p><code>gamlss</code> has the advantage of implementing a <em>lot</em>
of different statistical distributions.</p>
<p>The function <code>fitDist()</code> from <code>gamlss</code> will fit
the data to a selection of different statistical distributions,
calculate a measure of the goodness of fit, and return the best fit (and
information on all the others). Rather than testing against all 97
different distributions supported by <code>gamlss</code>, we can specify
only a selection, in this case <code>realplus</code>, that only includes
the 23 distributions that are defined for positive, real numbers:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fitDist</span><span class="op">(</span><span class="va">eruptions</span>, type <span class="op">=</span> <span class="st">"realplus"</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |                                                                      |   0%  |                                                                              |===                                                                   |   4%  |                                                                              |======                                                                |   9%  |                                                                              |=========                                                             |  13%  |                                                                              |============                                                          |  17%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |===============                                                       |  22%  |                                                                              |==================                                                    |  26%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |===========================                                           |  39%  |                                                                              |==============================                                        |  43%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================                                     |  48%  |                                                                              |=====================================                                 |  52%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |========================================                              |  57%  |                                                                              |===========================================                           |  61%  |                                                                              |==============================================                        |  65%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  74%</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  |                                                                              |=======================================================               |  78%  |                                                                              |==========================================================            |  83%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |=============================================================         |  87%Error in solve.default(oout$hessian) :
  Lapack routine dgesv: system is exactly singular: U[4,4] = 0
  |                                                                              |================================================================      |  91%  |                                                                              |===================================================================   |  96%  |                                                                              |======================================================================| 100%</code></pre>
</div>
<p>If you do this yourself, you will notice a lot of error-messages. It
is not possible to fit this particular data to <em>all</em> the
distributions, and the ones where the fit fails (enough), we will get an
error message.</p>
<p>The output from <code>fitDist()</code> will return the best fit:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>We are told that the statistical distribution that best fits the data
is <code>Weibull type 2</code> and that the AIC-measurement of goodness
of fit is 170.245.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Is that a good fit? That is a good question. It strongly depends on
the values in the dataset. In this dataset, the length of the eruptions
are measured in minutes If we choose to measure that length in another
unit, eg seconds, the distribution should not change. But the AIC
will.</p>
<p>We can use the AIC to decide that one distribution fits the data
better than another, but not to conclude that that distribution is the
correct one.</p>
</div>
</div>
</div>
<p>The <code>fit</code> object containing the output of the
<code>fitDist()</code> function contains quite a bit more.</p>
<p>If we start by getting the errors out of the way,
<code>fit$failed</code> returns the two distributions that failed enough
to cause errors:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">failed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
[1] "GIG"

[[2]]
[1] "LNO"</code></pre>
</div>
<p>As mentioned <code>fitDist()</code> fitted the data to 23 different
distributions. We can inspect the rest, and their associated AIC-values
like this:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">fits</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    WEI2     WEI3      WEI       GG    BCPEo     BCPE    BCCGo     BCCG
179.2449 179.2449 179.2449 181.1349 181.4953 181.4953 183.1245 183.1245
     GB2      BCT     BCTo   exGAUS       GA   LOGNO2    LOGNO       IG
183.1354 185.1245 185.1245 190.2994 194.4665 198.3047 198.3047 198.3558
  IGAMMA      EXP       GP PARETO2o  PARETO2
202.6759 861.8066 863.8067 863.8079 863.8081 </code></pre>
</div>
<p>Here we get <code>WEI2</code> first, with an AIC of 179.2449, but we
can see that <code>WEI3</code> and <code>WEI1</code> have almost exactly
the same AIC. Not that surprising if we guess that
<code>Weibull type 3</code> is probably rather similar to
<code>Weibull type 2</code>.</p>
<p>The difference in AIC for the first two distributions tested is very
small. Is it large enough for us to think that <code>WEI2</code> is
significantly better than <code>WEI3</code>?</p>
<p>No.¬†As a general rule of thumb, the difference between the AIC of two
distributions have to be larger than 2 for us to see a significant
difference.</p>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>*******************************************************************
Family:  c("WEI2", "Weibull type 2")

Call:  gamlssML(formula = y, family = DIST[i])

Fitting method: "nlminb"


Coefficient(s):
             Estimate  Std. Error  t value   Pr(&gt;|t|)
eta.mu    -18.6934274   1.1306427 -16.5334 &lt; 2.22e-16 ***
eta.sigma   2.5242093   0.0589965  42.7858 &lt; 2.22e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>And we can get at graphical description as well:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/which-distribution-rendered-plot-fit-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
	      Summary of the Quantile Residuals
                           mean   =  -0.001205749
                       variance   =  0.9953007
               coef. of skewness  =  0.09022876
               coef. of kurtosis  =  2.529951
Filliben correlation coefficient  =  0.9976953
******************************************************************</code></pre>
</div>
</section><section><h2 class="section-heading" id="what-about-the-other-options">What about the other options?<a class="anchor" aria-label="anchor" href="#what-about-the-other-options"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="general-comments">General comments<a class="anchor" aria-label="anchor" href="#general-comments"></a>
</h3>
<p>Above we got the ‚Äúbest‚Äù fit. But we also noted that in order for us
to conclude that one distribution is a better fit than another, the
difference in AIC should be at least 2.</p>
<p>What we are looking for might not actually be the probability
distribution that best fits our data. Our data might be noisy or there
might me systematic errors. The probability distribution we really want,
is the one that best matches the underlying data generating function,
the mechanisms in the real world that we are studying, that actually is
at the hearth of the data we collect.</p>
<p>We might not be able to find that. But we should consider if some of
the other possibilities provided by <code>fitDist()</code> might
actually be better.</p>

<p>First step is to look at the relevant distributions. In the setup
with <code>gamlss</code>, <code>gamlss.dist</code> and
<code>gamlss.add</code> we can test distributions of different types.
The complete list can be found using the help function for
<code>fitDist()</code>, but falls in the following families:</p>
<ul>
<li>realline - continuous distributions for all real values</li>
<li>realplus - continuous distributions for positive real values</li>
<li>realAll - all continuous distributions - the combination of realline
and realplus</li>
<li>real0to1 - continuous distributions defined for real values between
0 and 1</li>
<li>counts - distributions for counts</li>
<li>binom - binomial distributions</li>
</ul>
<p>Begin by considering which type whatever your data is describing,
best matches.</p>
</div>
<div class="section level3">
<h3 id="actually-looking-at-the-fits">Actually looking at the fits<a class="anchor" aria-label="anchor" href="#actually-looking-at-the-fits"></a>
</h3>
<p>For the selection of eruptions that we fitted, we chose the
‚Äúrealplus‚Äù selection of distibutions to test. We did that, because the
eruption times are all positive, and on the real number line.</p>
<div class="instructur">
<p>‚ÄúReal numbers‚Äù, p√• dansk reelle tal. Hvis du ved hvad imagin√¶re tal
er, ved du ogs√• hvad reelle tal er. Hvis ikke - s√• er reelle tal alle de
tal du vil t√¶nke p√• som tal.</p>
</div>
<p>Behind the scenes <code>fitDist</code> fits the data to the chosen
selection of distributions, and returns the best.</p>
<p>Looking at the result of the fit we see this:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Family:  c("WEI2", "Weibull type 2")
Fitting method: "nlminb"

Call:  gamlssML(formula = y, family = DIST[i])

Mu Coefficients:
[1]  -18.69
Sigma Coefficients:
[1]  2.524

 Degrees of Freedom for the fit: 2 Residual Deg. of Freedom   173
Global Deviance:     175.245
            AIC:     179.245
            SBC:     185.574 </code></pre>
</div>
<p>In the <code>Call</code> part of the output, we see this:</p>
<p><code>Call:  gamlssML(formula = y, family = DIST[i])</code></p>
<p>and from that we can deduces that if we want to fit the data to eg
the log-normal distribution (in the documentation we find that the
abbreviation for that is ‚ÄúLOGNO‚Äù), we can do it like this:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">log_norm_fit</span> <span class="op">&lt;-</span> <span class="fu">gamlss</span><span class="op">(</span><span class="va">eruptions</span> <span class="op">~</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="va">LOGNO</span>, data <span class="op">=</span> <span class="va">eruption_example</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>GAMLSS-RS iteration 1: Global Deviance = 194.3047
GAMLSS-RS iteration 2: Global Deviance = 194.3047 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">log_norm_fit</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>******************************************************************
Family:  c("LOGNO", "Log Normal")

Call:
gamlss(formula = eruptions ~ 1, family = LOGNO, data = eruption_example)

Fitting method: RS()

------------------------------------------------------------------
Mu link function:  identity
Mu Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.451832   0.007461   194.6   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
Sigma link function:  log
Sigma Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -2.31561    0.05345  -43.32   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

------------------------------------------------------------------
No. of observations in the fit:  175
Degrees of Freedom for the fit:  2
      Residual Deg. of Freedom:  173
                      at cycle:  2

Global Deviance:     194.3047
            AIC:     198.3047
            SBC:     204.6343
******************************************************************</code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The data generating function is not necessarily the same as the
distribution that best fit the data</li>
<li>Chose the distribution that best describes your data - not the one
that fits best</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-linear-regression"><p>Content from <a href="linear-regression.html">Linear regression</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I make a linear regression?</li>
<li>How do I interpret the results of a linear regression?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to fit data to a linear equation in one dimension</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>Here is some data, observations of the distance (in ft) it takes to
stop a car driving at different speeds (in mph):</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.4     ‚úî readr     2.1.5
‚úî forcats   1.0.0     ‚úî stringr   1.5.1
‚úî ggplot2   3.5.1     ‚úî tibble    3.2.1
‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1
‚úî purrr     1.0.4
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Not surprisingly the faster the car travels, the longer distance it
takes to stop it.</p>
<p>If we want to predict how long a car traveling at 10 mph takes to
stop, we could look at the observations at 10 mph and note that there is
some variation. We might take the average of those observations, and use
that as an estimate of how many feet it takes to stop a car traveling at
10 mph.</p>
<p>But what if we want to predict how long it takes to stop the car if
we are driving it at 12.5 mph instead? That would be nice to know, in
order to avoid hitting stuff. There are no observations in the data at
12.5 mph! We could estimate it as the average of the (average) stopping
distance at 12 mph and at 13 mph (21.5 and 35 ft respectively) and give
an estimate of 28.25 ft.</p>
<p>This is easy - 12.5 is exactly at the middle of the interval of 12 to
13 mph. But what if we want the distance at 12.4 mph?</p>
<p>Instead of fiddling with the numbers manually, we note that it
appears to be possible to draw a straight line through the points,
describing the connection between the two variables.</p>
<p>Let‚Äôs do that:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cars</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>,<span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points do not fall precisely on the line, but it‚Äôs not very
bad.</p>

<p>When we want to figure out how long it takes to stop a car driving at
12.5 mph, we can locate 12.5 on the x-axis, move vertically up to the
line, and read the corresponding value on the y-axis, about 30 mph.</p>
<p>But we can do better. Such a line can be described mathematically.
Straight lines in two dimensions can in general be described using the
formula:</p>
<p><span class="math display">\[
y = ax + b
\]</span> or, in this specific case:</p>
<p><span class="math display">\[
dist = a*speed + b
\]</span></p>
<p><code>a</code> and <code>b</code> are the coefficients of this
‚Äúmodel‚Äù. <code>a</code> is the slope, or how much the distance changes,
if we change speed by one. <code>b</code> is the intercept, the value
where the line crosses the y-axis. Or the distance it takes to stop a
car, traveling at a speed of 0 miles per hour - a value that does not
necessarily make sense, but is still a part of the model.</p>
<p>If we want to be very strict about it, that <code>=</code> is not
really equal. The expression describes the straight line, but the actual
observations do not actually fall on the line. If, for a given dist and
speed, we want the expression to actually be equal, there is some
variation that we need to include. We do that by adding a
<code>residual</code>:</p>
<p><span class="math display">\[
dist = a*speed + b + \epsilon
\]</span></p>
<p>And, if we want to be very mathematical concise, instead of using
<code>a</code>and <code>b</code> for the coefficients in the expression,
we would instead write it like this:</p>
<p><span class="math display">\[
dist = \beta_0 + \beta_1 speed + \epsilon
\]</span></p>
<p>That is all very nice. But how do we find the actual <code>a</code>
and <code>b</code> (or <span class="math inline">\(\beta_i\)</span>)?
What is the ‚Äúbest‚Äù line or model for this?</p>
<p>We do that by fitting <code>a</code> and <code>b</code> to values
that minimizes <span class="math inline">\(\epsilon\)</span>, that is,
we need to find the difference between the actual observed values, and
the prediction from the expression or model. Instead of looking at the
individual differences one by one, we look at the sum of the
differences, and minimizes that. However, the observed values can be
larger than the prediction, or smaller. The differences can therefore be
both negative and positive, and the sum can become zero because the
difference might cancel each other out.</p>
<p>To avoid that problem, we square the differences, and then minimize
the sum of the squares. That is the reason for calling the method for
minimizing <span class="math inline">\(\epsilon\)</span>, and by that
finding the optimal <code>a</code> and <code>b</code>, ‚Äúleast
squares‚Äù.</p>
<p>In a simple linear model like this, we can calculate the coefficients
directly:</p>
<p><span class="math display">\[\beta_1 = \frac{\sum_{i=1}^{n} (x_i -
\overline{x})(y_i - \overline{y})}{\sum_{i=1}^{n} (x_i -
\overline{x})^2}\]</span></p>
<p><span class="math display">\[\beta_0 = \overline{y} -
\beta_1\overline{x}\]</span></p>
<p>We do not want to do that - R can do it for us, with the function
<code>lm()</code></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></code></pre>
</div>
<p>y~x is the ‚Äúformula notation‚Äù in R, and describes that y is a
function of x.</p>
<p>Using the example from above:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">dist</span><span class="op">~</span><span class="va">speed</span>, data <span class="op">=</span> <span class="va">cars</span><span class="op">)</span></span></code></pre>
</div>
<p>We saved the result of the function in an object, in order to be able
to work with it. If we just want the coefficients, we can output the
result directly:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_model</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed
    -17.579        3.932  </code></pre>
</div>
<p>This gives us the coefficients of the model. The intercept,
<code>b</code> or <span class="math inline">\(\beta_0\)</span> is
-17.579. And the slope, <code>a</code> or <span class="math inline">\(\beta_1\)</span> is 3.932.</p>
<p>Having a negative intercept, or in this case any intercept different
from 0 does not make physical sense - a car travelling at 0 miles pr
hour should have a stopping distance of 0 ft.</p>
<p>The slope tells us, that if we increase the speed of the car by 1
mph, the stopping distance will increase by 3.932 ft.</p>
<div id="challenge-1-can-you-do-it" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1-can-you-do-it" class="callout-inner">
<h3 class="callout-title">Challenge 1: Can you do it?</h3>
<div class="callout-content">
<p>What stopping distance does the model predict if the speed i 12.5
mph?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>3.932*12.5 - 17.579 = 31.571 ft</p>
</div>
</div>
</div>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2-might-there-be-a-problem-with-that-prediction" class="callout-inner">
<h3 class="callout-title">Challenge 2: Might there be a problem with that prediction?</h3>
<div class="callout-content">

</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Yep. We might be able to measure the speed with the implied
precision. But the prediction implies a precision on the scale of
1/10000 mm.</p>
</div>
</div>
</div>
</div>
<p>We can get more details using the <code>summary()</code>
function:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max
-29.069  -9.525  -2.272   9.215  43.201

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -17.5791     6.7584  -2.601   0.0123 *
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,	Adjusted R-squared:  0.6438
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
<p>Let us look at that output in detail.</p>
<p><code>Call</code> simply repeats the model that we build, just in
case we have forgotten it - but also to have the actual model included
in the output, in order for other functions to access it and use it. We
will get to that.</p>
<p>The residuals are included. It is often important to take a look at
those, and we will do that shortly.</p>
<p>Now, the coefficients.</p>
<p>The estimates for intercept and speed, that is the intercept and the
slope of the line, are given. Those are the same we saw previously. We
also get a standard error. We need that for testing how much trust we
have in the result.</p>
<p>We are almost certain that the estimates of the values for intercept
and slope are not correct. They are estimates after all and we will
never know what the <em>true</em> values are. But we can test if they
are zero.</p>
<p>The hypothesis we can test is - is the coefficient for the slope
actually zero, even though the estimate we get is 3.9? If it is zero,
speed will not have any influence on the stopping distance. So; with
what certainty can we rule out that it is in fact zero?</p>
<p>We are testing the hypothesis that we have gotten a value for speed
of 3.9 by random chance, but that the true value is zero. If it is zero,
the value of 3.9 is 9.5 standard errors away from 0: 3.9324/0.4155 =
9.46426. And, using the t-distribution which describes these sorts of
things pretty well, that will happen very rarely. The Pr, or p-value, is
1.49e-12. That is the chance, or probability, that we will get a value
for the slope in our model that is 9.464 standard errors away from zero,
if the true value of the slope is zero.</p>
<p>In general if the p-value is smaller than 0.05, we reject the
hypothesis that the true value of the slope is 0.</p>
<p>Since we can assume that the estimates are normally distributed, we
can see that, <em>if</em> the true value of the slope was zero, the
value we get here, is 3.9324/0.4155 = 9.46426, standard errors away from
zero.</p>
<p>RSE is the squareroot of the sum of the squared residuals, divided by
the number of observations, <span class="math inline">\(n\)</span> minus
the number of parameters in the model, in this case 2. It is an estimate
of the average difference between the observed values, and the values
the model predicts. We want RSE to be as small as possible. What is
small? That depends on the size of the values. If we predict values in
the range of 0 to 2, an RSE of 15 is very large. If we predict values in
the range 0 to 1000, it is small.</p>
<p>Multiple R-squared, is a measure of how much of the variation in
<code>dist</code> that our model explains. In this case the model
explains ~65% of the variation. Not that impressive, but acceptable.</p>
<p>The adjusted R-squared adjusts the multiple R-square by the number of
independent variables in the model. It becomes an important measure of
how good the model is, when we get to multiple linear regression,
because we will get a better R-squared by adding independent variables,
even if these variables do not actually have any connection to the
dependent variables.</p>
<p>The F-statistic is 89.57 and has a p-value of 1.49e-12.</p>
<p>This tests our model against a model where all the slopes (we only
have one in this case) are 0; that is, is the overall model significant.
In this case it is, and there is overall strong evidence for the claim
that the speed of the car influences the stopping distance.</p>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Make a model, where you describe the length of the flipper of a
penguin, as a function of its weigth. You find data on penguins in the
library <code>palmerpenguins</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">palmerpenguins</span><span class="op">)</span></span>
<span><span class="va">penguin_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">flipper_length_mm</span><span class="op">~</span><span class="va">body_mass_g</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = flipper_length_mm ~ body_mass_g, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max
-23.7626  -4.9138   0.9891   5.1166  16.6392

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 1.367e+02  1.997e+00   68.47   &lt;2e-16 ***
body_mass_g 1.528e-02  4.668e-04   32.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.913 on 340 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.759,	Adjusted R-squared:  0.7583
F-statistic:  1071 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="testing-the-assumptions">Testing the assumptions<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
</h2>
<hr class="half-width">
<p>We can <em>always</em> make a linear model. The questions is: should
we?</p>
<p>There are certain assumptions that needs to be met in order to trust
a linear model.</p>
<ol style="list-style-type: decimal">
<li><p>There should be a linear connection between the dependent and
independent variable. We test that by comparing the observed values with
the predicted values (the straight line).</p></li>
<li><p>Independence. The observations needs to be independent. If one
measurement influences another measurement, we are not allowed to use a
linear model.</p></li>
<li><p>Normality of residuals. The residuals must be normally
distributed.</p></li>
</ol>
<p>In general we know our data well enough to determine if the first two
are fulfilled. The third assumptions can be tested using a
<code>qqplot</code>. We begin by extracting the residuals from our
model:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">linear_model</span><span class="op">)</span></span></code></pre>
</div>
<p>And then plotting them:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/linear-regression-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The points should be (close to be) on the straight line in the plot.
In this case they are close enough.</p>
<p>This is also a handy way to test if our data is normally
distributed.</p>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>Test if the residuals in our penguin model from before, are normally
distributed.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_residuals</span> <span class="op">&lt;-</span> <span class="fu">residuals</span><span class="op">(</span><span class="va">penguin_model</span><span class="op">)</span></span>
<span><span class="fu">qqnorm</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span>
<span><span class="fu">qqline</span><span class="op">(</span><span class="va">penguin_residuals</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/linear-regression-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure">
They are relatively close to normal.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Linear regression show the (linear) relationship between
variables.</li>
<li>The assumption of normalcy is on the residuals, not the data!</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-multiple-linear-regression"><p>Content from <a href="multiple-linear-regression.html">Multiple Linear Regression</a></p>
<hr>
<p>Last updated on 2025-03-31 |

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/episodes/multiple-linear-regression.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you run a multiple linear regression?</li>
<li>What about conditional effects?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to build and trim a model with multiple independent
variabels</li>
<li>Learn how to build a model with interaction terms</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>A linear regression is relatively simple to understand and visualise.
We have a dependent variable that we try to predict - model - using an
independent variable. In principle we can change the independent
variable, and the model will predict the change in the dependent
variable. We can visualise this using a relatively simple graph,
plotting the two variables against each other, and adding the line
representing the model.</p>
<p>But what if we have reason to believe that the dependent variable
depends on more than one independent variable?</p>
<p>Let us find some data for illustrating this.</p>
<p>Before anything else, we load the <code>tidyverse</code> package,
download the data, and read it using <code>read_csv()</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span><span class="fu">download.file</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/KUBDatalab/R-toolbox/main/episodes/data/BONEDEN.csv"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data/BONEDEN.csv"</span>, mode <span class="op">=</span> <span class="st">"wb"</span><span class="op">)</span></span>
<span><span class="va">boneden</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/BONEDEN.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>The data records the bonedensity in different parts of the skeleton
of female monozygotic twins, as well as height, age, weight, smoking,
alcohol, tea and coffee-habits. We are going to study the second twins,
where all variables are suffixed with the digit ‚Äú2‚Äù:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">boneden</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">density</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 6 √ó 12
    age   ht2   wt2  tea2  cof2  alc2  cur2  men2  pyr2   ls2   fn2   fs2
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    27   160    56    42    21     0     0     0  13.8  0.76  0.68  1.04
2    42   159    72    20    21     1     1     0  48    0.89  0.64  1.11
3    59   156    54     7    28     0     0     1  20.5  0.51  0.64  0.86
4    61   162    58    21    35     0     0     1  29.8  0.85  0.69  1.03
5    47   150    58    91     0     0     1     1  25    0.59  0.54  0.96
6    33   158    54    14    14     0     0     0   5    0.83  0.5   1.06</code></pre>
</div>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The package <code>tidyselect</code> is a part of the
<code>tidyverse</code>. It contains functions that allow us to choose
variables/columns based on patterns in their names rather than
specifying the names directly. <code>contains("2")</code> here return
all columns with a name containing the string ‚Äú2‚Äù.</p>
</div>
</div>
</div>
<p>More specically we are trying to model the bone density in the
femoral shaft (l√•rbensskaft). As an intial hypothesis, we are going to
assume that the density depends on height (<code>ht2</code>), age
(<code>age</code>), weight (<code>wt2</code>), tea (<code>tea2</code>)
and coffee consumption (<code>cof2</code>).</p>
<p>That is, we assume that there is a linear correlation between the
bone density and each of the independent variables.</p>
<p>The simple linear regresion between just the bone density and the
height, can be done with:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.41406 -0.02810  0.00190  0.07658  0.30722

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -1.78744    0.71928  -2.485 0.017351 *
ht2          0.01766    0.00445   3.969 0.000301 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1315 on 39 degrees of freedom
Multiple R-squared:  0.2877,	Adjusted R-squared:  0.2694
F-statistic: 15.75 on 1 and 39 DF,  p-value: 0.0003006</code></pre>
</div>
<p>Where we pipe the output of the regression to the summary function to
take a closer look. There is a significant correlation between bone
density and height. If we increase the height of a woman by one
centimeter, the density of her femoral shaft is expected to increase by
0.0177 <span class="math inline">\(g/cm^3\)</span>. The correlation is
significant, that is, we are rather sure that the estimate of this
coefficient is different from 0.</p>
<p>Now we would like to add the other independent variables to the
model.</p>
<p>The model we are building can be described using math as:</p>
<p><span class="math display">\[ \text{fs2} = w_0 + w_1\text{ht2} +
w_2\text{wt2} + w_3\text{tea2} + w_4\text{cof2} + \epsilon  \]</span>
That is - we would like to figure out which coefficients <span class="math inline">\(w_1\)</span> to <span class="math inline">\(w_4\)</span>, and which intercept <span class="math inline">\(w_0\)</span> will give us estimates of fs2, that
minimizes the error <span class="math inline">\(\epsilon\)</span></p>
<p>This is pretty straight forward. Instead of running
<code>lm(fs2~ht2, data = density</code>, we add the additional
independent variables using the <code>+</code> sign. And again we pipe
the result to the summary function to take a closer look:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span> <span class="op">+</span> <span class="va">cof2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2 + cof2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.247601 -0.061517  0.005634  0.067826  0.166474

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2800114  0.7774507  -0.360 0.720887
ht2          0.0090956  0.0046455   1.958 0.058246 .
age         -0.0068373  0.0015669  -4.364 0.000108 ***
wt2          0.0038274  0.0014934   2.563 0.014836 *
tea2        -0.0009246  0.0009837  -0.940 0.353677
cof2        -0.0005310  0.0009328  -0.569 0.572778
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1043 on 35 degrees of freedom
Multiple R-squared:  0.5978,	Adjusted R-squared:  0.5403
F-statistic:  10.4 on 5 and 35 DF,  p-value: 3.566e-06</code></pre>
</div>
<p>It is <em>that</em> simple. Interpreting the results on the other
hand is a bit more complicated.</p>
<p>The bone density, for a newborn woman (0 years old), that is 0
centimeters high, weighing 0 kilogram, who does not drink either tea or
coffee, is -0.28 <span class="math inline">\(g/cm^3\)</span> - which is
obviously either impossible, or a discovery that would get you an
invitation to Stockholm.</p>
<p>For each centimeter the woman grows, <em>if all other variables are
held constant!</em> the bone density is expected to <em>increase</em> by
0.0091 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each year the woman grows older, <em>if all other variables are
held constant!</em> the bone density is expected to <em>decrease</em> by
0.0068 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>For each kilogram the woman puts on weight, <em>if all other
variables are held constant!</em> the bone density is expected to
<em>increase</em> by 0.0038 <span class="math inline">\(g/cm^3\)</span>.</p>
<p>The coefficient for the height variable is not significant (if we
have decided on a 5% significanse level), and neither consumption of teo
nor coffee has a significant influence on bone density. According to
this model.</p>
<p>Is this a good model? No.¬†The coefficients for Tea and coffee
consumption are not significant, and should not be in the model. Let us
remove them.</p>
<p>But let us remove them one by one. First coffee that has the worst
p-value:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">tea2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + tea2, data = density)

Residuals:
     Min       1Q   Median       3Q      Max
-0.26036 -0.06261  0.01682  0.06366  0.17393

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.2209640  0.7632342  -0.290   0.7739
ht2          0.0085364  0.0044976   1.898   0.0657 .
age         -0.0068645  0.0015514  -4.425 8.58e-05 ***
wt2          0.0041140  0.0013927   2.954   0.0055 **
tea2        -0.0007497  0.0009257  -0.810   0.4233
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1034 on 36 degrees of freedom
Multiple R-squared:  0.5941,	Adjusted R-squared:  0.5489
F-statistic: 13.17 on 4 and 36 DF,  p-value: 1.048e-06</code></pre>
</div>
<p>Note that not only is the coefficient for tea still not significant,
it actually gets ‚Äúworse‚Äù. On the other hand, the coefficient for weight
now is larger, ie explains more of the variation.</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Why does this happen?</p>
<p>What the model does is ‚Äútrying‚Äù to explain the variation in
<code>fs2</code>, using the independent variables. We have an underlying
assumption that we can change those variables independently. However,
they are often correlated. In this case there is a relatively large
correlation between <code>cof2</code> and <code>wt2</code>. When we
remove <code>cof2</code> from the model, some of the variation explained
by <code>cof2</code> can now be captured by <code>wt2</code>.</p>
</div>
</div>
</div>
<p>We do not actually explain that much of the variation in
<code>fs2</code>. The R<sup>2</sup> value tells us how much of the
variation is explained by the model, and 0.5941 is not <em>that</em>
impressive. We will be able to explain everything, including random
noise in the data. We just need to add enough independent variables to
our model. Some of the random noise will be explained by even a random
varible.</p>
<p>This is called <code>overfitting</code>, and one of ways we try to
identify that, is by looking at the <code>Adjusted R-squared</code>
instead. This adjusts the R<sup>2</sup> for the number of variables we
have in the model. This is the measure of how good the model is, that we
prefer.</p>
<p>We continue our ‚Äúleave-one-out‚Äù approach. <code>tea2</code> is the
‚Äúworst‚Äù performing variable measured by the p-value, and that is the
next one we will remove:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> , data <span class="op">=</span> <span class="va">density</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.273490 -0.058038  0.005241  0.067527  0.169512

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.569569   0.627355  -0.908  0.36981
ht2          0.010524   0.003751   2.806  0.00796 **
age         -0.006489   0.001474  -4.404 8.74e-05 ***
wt2          0.004077   0.001385   2.943  0.00559 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1029 on 37 degrees of freedom
Multiple R-squared:  0.5867,	Adjusted R-squared:  0.5531
F-statistic:  17.5 on 3 and 37 DF,  p-value: 3.078e-07</code></pre>
</div>
<p>Now we have a model where all coefficients are significant.</p>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>What about the intercept?</p>
<p>The estimate of the intercept is not significant. Is that a
problem?</p>
<p>No, not in this case. The intercept is the estimate of what
<code>fs2</code> would be if all the independent variables are 0. That
might be meaningful for age, but definitely not for height or
weight.</p>
<p>Also the thing we are interested in is not actually making
predictions, in that case we would like a better estimate of the
intercept, but in studying the effect of height, age and weight on
bonedensity.</p>
</div>
</div>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>The dataset contains more variables than we have examined here.
Alcohol consumption <code>alc</code>, and how many years the individual
women have been smoking <code>pyr</code>.</p>
<p>We also only studied half of the dataset, the variables ending in
‚Äú2‚Äù. Data on the other twins have variables ending in ‚Äú1‚Äù.</p>
<p>Build a model predicting the bonedensity of the femoral shaft
<code>fs1</code> using a selection of the variables <code>age</code>,
ht1<code>,</code>wt1<code>,</code>tea1<code>,</code>cof1<code>,</code>alc1<code>and</code>pyr1`.</p>
<p>Make sure that only significant (p&lt;0.05) variables are
included.</p>
<p>What is the adjusted R squared value?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dens_exercise</span> <span class="op">&lt;-</span> <span class="va">boneden</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"1"</span><span class="op">)</span>, <span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="va">cur1</span>, <span class="va">ls1</span>, <span class="va">fn1</span>, <span class="va">men1</span> <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span><span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span><span class="op">+</span> <span class="va">cof1</span> <span class="op">+</span> <span class="va">alc1</span> <span class="op">+</span><span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_3</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span> <span class="op">+</span> <span class="va">alc1</span> <span class="op">+</span><span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_4</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">wt1</span> <span class="op">+</span> <span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_5</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span> <span class="op">+</span> <span class="va">pyr1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span><span class="va">model_6</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs1</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ht1</span>, data <span class="op">=</span> <span class="va">dens_exercise</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">model_6</span><span class="op">)</span><span class="op">$</span><span class="va">adj.r.squared</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.2555525</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="categorical-data">Categorical data<a class="anchor" aria-label="anchor" href="#categorical-data"></a>
</h2>
<hr class="half-width">
<p>We also have categorical variables in the data. Can we use them?</p>
<p>Yes!</p>
<div class="section level3">
<h3 id="first-way---categorical-values-as-independent-variables">First way - categorical values as independent variables<a class="anchor" aria-label="anchor" href="#first-way---categorical-values-as-independent-variables"></a>
</h3>
<p>Let us add information about menopausal status,
<code>men2</code>:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">density</span> <span class="op">&lt;-</span> <span class="va">density</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>men2 <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">men2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cat_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span> <span class="op">+</span> <span class="va">men2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">cat_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 + men2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.282979 -0.049356 -0.006728  0.066710  0.171457

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.532553   0.643852  -0.827 0.413764
ht2          0.010650   0.003898   2.732 0.009799 **
age         -0.008232   0.002098  -3.924 0.000389 ***
wt2          0.004191   0.001414   2.963 0.005450 **
men21        0.053401   0.051460   1.038 0.306514
men22       -0.026286   0.059796  -0.440 0.662939
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1032 on 35 degrees of freedom
Multiple R-squared:  0.6067,	Adjusted R-squared:  0.5505
F-statistic:  10.8 on 5 and 35 DF,  p-value: 2.462e-06</code></pre>
</div>
<p>There are three different categorical values in <code>men2</code>. 0:
premenopausal, 1: Postmenopausal and 2: Unknown or hysterectomy.</p>
<p>If we want to add categorical data to the model, we need to make sure
they are encoded as categorical, otherwise the model will treat them as
continous values. We do that by running <code>factor()</code> on the
relevant variable.</p>
<p>Again this is relatively simple, the interpretation on the other hand
is a bit more complex. The coefficients for <code>ht2</code>,
<code>age</code> and <code>wt2</code> now tells us how the value of
<code>fs2</code> changes for the base case 0, premenopausal. The
coefficient of <code>factor(men2)1</code> tells us that there is an
added ‚Äúbonus‚Äù to the bonedensity to become postmenopausal. And
<code>factor(men2)2</code> that there is a ‚Äúpenalty‚Äù of -0.026286 to
have the ‚Äúunknown‚Äù status. The coefficients are not significant, so this
might be a bad example.</p>
</div>
<div class="section level3">
<h3 id="the-second-way---interaction">The second way - interaction<a class="anchor" aria-label="anchor" href="#the-second-way---interaction"></a>
</h3>
<p>Maybe the influence of menopause status is not direct, but rather in
the form that the coefficient for <code>wt2</code> depends on menopausal
status. Ie increasing weight might lead to increasing bonedensity. But
to different degrees depending on menopausal status.</p>
<p>We can add this interaction term to the model by multiplying the
categorical variable to the variabel where we suspect that there might
be an interaction:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interact_model</span> <span class="op">&lt;-</span> <span class="fu">lm</span><span class="op">(</span><span class="va">fs2</span> <span class="op">~</span> <span class="va">ht2</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">wt2</span><span class="op">*</span><span class="va">men2</span>, data <span class="op">=</span> <span class="va">density</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">interact_model</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Call:
lm(formula = fs2 ~ ht2 + age + wt2 * men2, data = density)

Residuals:
      Min        1Q    Median        3Q       Max
-0.264590 -0.053534 -0.000568  0.057129  0.168441

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -0.355334   0.648878  -0.548 0.587642
ht2          0.009842   0.004014   2.452 0.019661 *
age         -0.007966   0.002084  -3.823 0.000555 ***
wt2          0.003272   0.002281   1.434 0.160913
men21       -0.166698   0.196497  -0.848 0.402355
men22        0.149021   0.264316   0.564 0.576703
wt2:men21    0.003455   0.003070   1.126 0.268439
wt2:men22   -0.002592   0.004025  -0.644 0.524081
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1021 on 33 degrees of freedom
Multiple R-squared:  0.637,	Adjusted R-squared:  0.5601
F-statistic: 8.274 on 7 and 33 DF,  p-value: 8.211e-06</code></pre>
</div>
<p>Once again it is ‚Äúsimple‚Äù to do, more complicated to interpret.</p>
<p>The (estimated) coefficients for <code>ht2</code>and <code>age</code>
should be understood as before.</p>
<p>But now we have a good deal more coefficients.
<code>factor(men2)1</code> and <code>factor(men2)2</code> should also be
understood as before.</p>
<p><code>wt2</code> is also still the same as before. But we have two
new. If the specific woman is postmenopausal, there is an additional
term, wt2:men21 that needs to be added to the prediction.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge</h3>
<div class="callout-content">
<p>What is the prediction for <code>fs2</code> for a 52 year old, 164
centimeter high, postmenopausal woman weighing 62 kg?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>We find it by adding all the terms:</p>
<ul>
<li>intercept: -0.355334</li>
<li>52 √ó age: 52 √ó -0.007966 = -0.414232</li>
<li>164 √ó ht2: 164 √ó 0.009842 = 1.613488</li>
<li>62 √ó wt2: 62 √ó 0.003272 = 0.202864</li>
<li>factor(men2)1 = -0.166698 (because men2 is = 1)</li>
<li>65 √ó wt2:men21 = 62 √ó 0.003455 = 0.21421</li>
</ul>
<p>The result is: 1.094298</p>
<p>An alternative way would be to construct a dataframe containing the
values for which we want to make the prediction, and use the
<code>predict</code> function:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  ht2 <span class="op">=</span> <span class="fl">164</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">52</span>,</span>
<span>  wt2 <span class="op">=</span> <span class="fl">62</span>,</span>
<span>  men2 <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="fl">1</span>, levels <span class="op">=</span> <span class="fu">levels</span><span class="op">(</span><span class="va">density</span><span class="op">$</span><span class="va">men2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">predict</span><span class="op">(</span><span class="va">interact_model</span>, newdata <span class="op">=</span> <span class="va">new_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span>       <span class="fl">1</span></span>
<span><span class="fl">1.094928</span> </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>We can do linear regression on multiple independent variables</li>
<li>Be careful not to overfit - only retain variables that are
significant (and sensible)</li>
<li>We can fit just as well on categorical variables - but make sure
they <em>are</em> categorical</li>
<li>Interpreting linear models with multiple variables are not trivial _
Interpreting linear models with interaction terms are even less
trivial</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/KUBDatalab/R-statistic/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/KUBDatalab/R-statistic/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-statistic/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-statistic/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC BY-NC-SA 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.11" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://KUBDatalab.github.io/R-statistic/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-statistic/aio.html",
  "identifier": "https://KUBDatalab.github.io/R-statistic/aio.html",
  "dateCreated": "2025-03-10",
  "dateModified": "2025-03-31",
  "datePublished": "2025-03-31"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

